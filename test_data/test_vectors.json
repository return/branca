{
  "version": "0.1",
  "numberOfTests": 18,
  "testGroups": [
    {
      "testType": "encoding and decoding",
      "tests": [
        {
          "id": 0,
          "comment": "Non-utf8 is correct.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 123206400,
          "token": "K9u6d0zjXp8RXNUGDyXAsB9AtPo60CD3xxQ2ulL8aQoTzXbvockRff0y1eXoHm",
          "msg": "80",
          "is_valid": true
        },
        {
          "id": 1,
          "comment": "Empty input message is correct.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 0,
          "token": "4sfD0vPFhIif8cy4nB3BQkHeJqkOkDvinI4zIhMjYX4YXZU5WIq9ycCVjGzB5",
          "msg": "",
          "is_valid": true
        },
        {
          "id": 2,
          "comment": "Invalid nonce (NOTE: token is invalid as well).",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "dead",
          "timestamp": 0,
          "token": "870S4BYkkjLle9LOsVbkF2iLHt55PcPSXBDnBTVyXdIZ8OHTMtya7FA29IITW1bYphyllRWGmsGIg",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 3,
          "comment": "Zero timestamp.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 0,
          "token": "870S4BYxgHw0KnP3W9fgVUHEhT5g86vJ17etaC5Kh5uIraWHCI1psNQGv298ZmjPwoYbjDQ9chy2z",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": true
        },
        {
          "id": 4,
          "comment": "Max timestamp.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 4294967295,
          "token": "89i7YCwu5tWAJNHUDdmIqhzOi5hVHOd4afjZcGMcVmM4enl4yeLiDyYv41eMkNmTX6IwYEFErCSqr",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": true
        },
        {
          "id": 5,
          "comment": "November 27th timestamp.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 123206400,
          "token": "875GH23U0Dr6nHFA63DhOyd9LkYudBkX8RsCTOMz5xoYAMw9sMd5QwcEqLDRnTDHPenOX7nP2trlT",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": true
        },
        {
          "id": 6,
          "comment": "Eight null bytes with zero timestamp.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 0,
          "token": "1jIBheHbDdkCDFQmtgw4RUZeQoOJgGwTFJSpwOAk3XYpJJr52DEpILLmmwYl4tjdSbbNqcF1",
          "msg": "0000000000000000",
          "is_valid": true
        },
        {
          "id": 7,
          "comment": "Eight null bytes with max timestamp.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 4294967295,
          "token": "1jrx6DUu5q06oxykef2e2ZMyTcDRTQot9ZnwgifUtzAphGtjsxfbxXNhQyBEOGtpbkBgvIQx",
          "msg": "0000000000000000",
          "is_valid": true
        },
        {
          "id": 8,
          "comment": "Eight null bytes with november 27th timestamp.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": "beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef",
          "timestamp": 123206400,
          "token": "1jJDJOEjuwVb9Csz1Ypw1KBWSkr0YDpeBeJN6NzJWx1VgPLmcBhu2SbkpQ9JjZ3nfUf7Aytp",
          "msg": "0000000000000000",
          "is_valid": true
        }
      ]
    },
    {
      "testType": "decoding",
      "tests": [
        {
          "id": 9,
          "comment": "Wrong version - this token was created with version 0xBB.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 0,
          "token": "89mvl3RkwXjpEj5WMxK7GUDEHEeeeZtwjMIOogTthvr44qBfYtQSIZH5MHOTC0GzoutDIeoPVZk3w",
          "msg": "",
          "is_valid": false
        },
        {
          "id": 10,
          "comment": "Invalid base62.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 123206400,
          "token": "875GH23U0Dr6nHFA63DhOyd9LkYudBkX8RsCTOMz5xoYAMw9sMd5QwcEqLDRnTDHPenOX7nP2trlT_",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 11,
          "comment": "Modified version after token creation.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 0,
          "token": "89i7YCx9usiQoaTtdaibIQ7goaYbRkXRDRAoEcg3g99OwFaKlb1kyo25vCzJZEzmT7tzFTqYV9xhM",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 12,
          "comment": "Modified first byte of the nonce.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 0,
          "token": "875GH233SUysT7fQ711EWd9BXpwOjB72ng3ZLnjWFrmOqVy49Bv93b78JU5331LbcY0EEzhLfpmSx",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 13,
          "comment": "Modified first byte of the timestamp.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 0,
          "token": "870g1RCk4lW1YInhaU3TP8u2hGtfol16ettLcTOSoA0JIpjCaQRW7tQeP6dQmTvFIB2s6wL5deMXr",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 14,
          "comment": "Modified last byte of the ciphertext.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 0,
          "token": "875GH23U0Dr6nHFA63DhOyd9LkYudBkX8RsCTOMz5xoYAMw9sMd5Qw6Jpo96myliI3hHD7VbKZBYh",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 15,
          "comment": "Modified last byte of the Poly1305 tag.",
          "key": "supersecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 0,
          "token": "875GH23U0Dr6nHFA63DhOyd9LkYudBkX8RsCTOMz5xoYAMw9sMd5QwcEqLDRnTDHPenOX7nP2trk0",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 16,
          "comment": "Wrong key - different key was used to create token.",
          "key": "wrongsecretkeyyoushouldnotcommit",
          "nonce": null,
          "timestamp": 0,
          "token": "870S4BYxgHw0KnP3W9fgVUHEhT5g86vJ17etaC5Kh5uIraWHCI1psNQGv298ZmjPwoYbjDQ9chy2z",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        },
        {
          "id": 17,
          "comment": "Invalid key - one bytes less than required.",
          "key": "tooshortkey",
          "nonce": null,
          "timestamp": 0,
          "token": "870S4BYxgHw0KnP3W9fgVUHEhT5g86vJ17etaC5Kh5uIraWHCI1psNQGv298ZmjPwoYbjDQ9chy2z",
          "msg": "48656c6c6f20776f726c6421",
          "is_valid": false
        }
      ]
    } 
  ]
}